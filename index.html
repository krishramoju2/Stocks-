<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfinityBot - Ultimate AI Assistant</title>
    <style>
        :root {
            --primary: #6e48aa;
            --secondary: #9d50bb;
            --dark: #1a1a2e;
            --light: #f1f1f1;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --info: #2196F3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            min-height: 100vh;
            background-image: radial-gradient(circle at 10% 20%, rgba(110, 72, 170, 0.2) 0%, rgba(157, 80, 187, 0.2) 90%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .theme-selector {
            display: flex;
            gap: 10px;
        }
        
        .theme-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid var(--light);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .theme-btn:hover {
            transform: scale(1.1);
        }
        
        .theme-1 { background: linear-gradient(135deg, #6e48aa, #9d50bb); }
        .theme-2 { background: linear-gradient(135deg, #1a1a2e, #16213e); }
        .theme-3 { background: linear-gradient(135deg, #1e3c72, #2a5298); }
        .theme-4 { background: linear-gradient(135deg, #614385, #516395); }
        .theme-5 { background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); }
        .theme-6 { background: linear-gradient(135deg, #ff416c, #ff4b2b); }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }
        
        .sidebar {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-title i {
            font-size: 20px;
        }
        
        .tone-control {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .tone-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .persona-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            margin-bottom: 15px;
        }
        
        .feature-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }
        
        .feature-btn:hover {
            background-color: rgba(110, 72, 170, 0.3);
            border-color: var(--primary);
        }
        
        .feature-btn i {
            margin-right: 10px;
        }
        
        .chat-container {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 80vh;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 20px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 10px;
            line-height: 1.6;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background-color: rgba(110, 72, 170, 0.3);
            border-left: 4px solid var(--primary);
            margin-left: 40px;
        }
        
        .bot-message {
            background-color: rgba(26, 26, 46, 0.6);
            border-left: 4px solid var(--secondary);
            margin-right: 40px;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .message-content {
            white-space: pre-wrap;
        }
        
        .code-block {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }
        
        .text-input {
            flex: 1;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            resize: none;
            min-height: 60px;
            max-height: 150px;
        }
        
        .text-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .send-btn {
            padding: 0 20px;
            border-radius: 5px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .send-btn:hover {
            transform: scale(1.05);
        }
        
        .file-upload {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            background-color: rgba(110, 72, 170, 0.3);
            border-color: var(--primary);
        }
        
        .file-upload input {
            display: none;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .stat-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .emotion-indicator {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .emotion-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .anger { background-color: var(--danger); }
        .joy { background-color: var(--success); }
        .sadness { background-color: var(--info); }
        .surprise { background-color: var(--warning); }
        .neutral { background-color: rgba(255, 255, 255, 0.5); }
        
        .timeline-container {
            margin-top: 30px;
        }
        
        .timeline-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .timeline {
            position: relative;
            max-height: 200px;
            overflow-y: auto;
            padding-left: 20px;
            border-left: 2px solid var(--primary);
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 20px;
            cursor: pointer;
        }
        
        .timeline-item:last-child {
            padding-bottom: 0;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--secondary);
        }
        
        .timeline-date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .timeline-content {
            font-size: 14px;
            margin-top: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 15px;
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 10px;
            margin-bottom: 15px;
            width: fit-content;
            align-items: center;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--secondary);
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        .context-window {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .context-window.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .context-content {
            background-color: var(--dark);
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--primary);
            position: relative;
        }
        
        .close-context {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
        }
        
        .context-title {
            margin-bottom: 20px;
            color: var(--secondary);
        }
        
        .context-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .context-item:hover {
            background-color: rgba(110, 72, 170, 0.1);
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--dark);
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--primary);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            color: var(--secondary);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--light);
            font-size: 24px;
            cursor: pointer;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-btn {
            padding: 8px 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }

        .primary-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
        }

        .secondary-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }

        /* Flashcard styles */
        .flashcard-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .flashcard {
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid var(--secondary);
            cursor: pointer;
            transition: transform 0.3s;
        }

        .flashcard:hover {
            transform: translateY(-3px);
        }

        .flashcard-question {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .flashcard-answer {
            display: none;
            padding-top: 10px;
            border-top: 1px dashed rgba(255, 255, 255, 0.2);
        }

        .flashcard.show-answer .flashcard-answer {
            display: block;
        }

        /* Cheatsheet styles */
        .cheatsheet-section {
            margin-bottom: 20px;
        }

        .cheatsheet-title {
            color: var(--secondary);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cheatsheet-item {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
        }

        .cheatsheet-item::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--secondary);
        }

        /* Mental Health styles */
        .mh-question {
            margin-bottom: 15px;
        }

        .mh-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mh-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mh-option input {
            accent-color: var(--secondary);
        }

        .mh-result {
            display: none;
            padding: 15px;
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--info);
        }

        /* Translation styles */
        .translation-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .translation-box {
            display: flex;
            flex-direction: column;
        }

        .translation-textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            resize: none;
            margin-bottom: 10px;
        }

        .language-select {
            padding: 8px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .sidebar {
                margin-bottom: 20px;
            }

            .translation-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">InfinityBot</div>
            <div class="theme-selector">
                <div class="theme-btn theme-1" data-theme="1"></div>
                <div class="theme-btn theme-2" data-theme="2"></div>
                <div class="theme-btn theme-3" data-theme="3"></div>
                <div class="theme-btn theme-4" data-theme="4"></div>
                <div class="theme-btn theme-5" data-theme="5"></div>
                <div class="theme-btn theme-6" data-theme="6"></div>
            </div>
        </header>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-title">Response Time</div>
                <div class="stat-value">0.24s</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Context Length</div>
                <div class="stat-value">∞</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Languages</div>
                <div class="stat-value">127</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Emotions Detected</div>
                <div class="stat-value">27</div>
                <div class="emotion-indicator">
                    <div class="emotion-dot anger" title="Anger"></div>
                    <div class="emotion-dot joy" title="Joy"></div>
                    <div class="emotion-dot sadness" title="Sadness"></div>
                    <div class="emotion-dot surprise" title="Surprise"></div>
                    <div class="emotion-dot neutral" title="Neutral"></div>
                    <div class="emotion-dot" style="color: rgba(255,255,255,0.7); font-size: 10px;">+22</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-sliders-h"></i> Tone Control</div>
                    <input type="range" min="0" max="100" value="50" class="tone-control" id="tone-slider">
                    <div class="tone-labels">
                        <span>Casual</span>
                        <span>Professional</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-user-alt"></i> Persona Mode</div>
                    <select class="persona-select" id="persona-select">
                        <option value="default">Default</option>
                        <option value="sun_tzu">Sun Tzu</option>
                        <option value="mr_robot">Mr. Robot</option>
                        <option value="defcon">DEFCON Speaker</option>
                        <option value="sherlock">Sherlock Holmes</option>
                        <option value="einstein">Albert Einstein</option>
                        <option value="custom">Custom...</option>
                    </select>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-magic"></i> Features</div>
                    <button class="feature-btn" id="screenshot-btn"><i class="fas fa-camera"></i> Screenshot to Code</button>
                    <button class="feature-btn" id="translate-btn"><i class="fas fa-language"></i> Multilingual Translation</button>
                    <button class="feature-btn" id="cheatsheet-btn"><i class="fas fa-file-alt"></i> Create Cheat Sheet</button>
                    <button class="feature-btn" id="flashcard-btn"><i class="fas fa-layer-group"></i> Generate Flashcards</button>
                    <button class="feature-btn" id="mental-health-btn"><i class="fas fa-heart"></i> Mental Health Check</button>
                    <button class="feature-btn" id="context-btn"><i class="fas fa-infinity"></i> Infinite Context</button>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-history"></i> Timeline</div>
                    <div class="timeline-container">
                        <div class="timeline" id="timeline">
                            <!-- Timeline items will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <div class="message bot-message">
                        <div class="message-header">
                            <span>InfinityBot</span>
                            <span>Just now</span>
                        </div>
                        <div class="message-content">
                            Hello! I'm InfinityBot, your ultimate AI assistant with infinite memory and advanced capabilities. How can I help you today?
                        </div>
                    </div>
                </div>
                
                <div class="input-area">
                    <label class="file-upload" title="Upload screenshot or file">
                        <input type="file" id="file-input" accept="image/*,.pdf,.doc,.docx,.txt">
                        <i class="fas fa-paperclip"></i>
                    </label>
                    <textarea class="text-input" id="user-input" placeholder="Type your message here..."></textarea>
                    <button class="send-btn" id="send-btn"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Context Window -->
    <div class="context-window" id="context-window">
        <div class="context-content">
            <button class="close-context" id="close-context">&times;</button>
            <h3 class="context-title">Infinite Context Memory</h3>
            <div id="context-list">
                <!-- Context items will be added here dynamically -->
            </div>
        </div>
    </div>
    
    <!-- Screenshot to Code Modal -->
    <div class="modal" id="screenshot-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-camera"></i> Screenshot to Code</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Upload a screenshot of a UI design and I'll convert it to HTML/CSS code.</p>
                <input type="file" id="screenshot-upload" accept="image/*" style="margin: 15px 0;">
                <div id="screenshot-preview" style="text-align: center; margin: 15px 0; display: none;">
                    <img id="preview-image" style="max-width: 100%; max-height: 300px; border-radius: 5px;">
                </div>
                <div id="generated-code" style="display: none;">
                    <h4 style="margin-bottom: 10px;">Generated Code:</h4>
                    <div class="code-block" id="code-output"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary-btn close-modal">Cancel</button>
                <button class="modal-btn primary-btn" id="generate-code-btn">Generate Code</button>
            </div>
        </div>
    </div>
    
    <!-- Translation Modal -->
    <div class="modal" id="translation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-language"></i> Multilingual Translation</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="translation-container">
                    <div class="translation-box">
                        <select class="language-select" id="source-language">
                            <option value="auto">Detect Language</option>
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="ru">Russian</option>
                            <option value="ar">Arabic</option>
                        </select>
                        <textarea class="translation-textarea" id="source-text" placeholder="Enter text to translate"></textarea>
                    </div>
                    <div class="translation-box">
                        <select class="language-select" id="target-language">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="ru">Russian</option>
                            <option value="ar">Arabic</option>
                        </select>
                        <textarea class="translation-textarea" id="translated-text" placeholder="Translation will appear here" readonly></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary-btn close-modal">Cancel</button>
                <button class="modal-btn primary-btn" id="translate-text-btn">Translate</button>
            </div>
        </div>
    </div>
    
    <!-- Cheatsheet Modal -->
    <div class="modal" id="cheatsheet-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-file-alt"></i> Create Cheat Sheet</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter a topic and I'll generate a comprehensive cheat sheet for you.</p>
                <input type="text" id="cheatsheet-topic" placeholder="Enter topic (e.g., Python, CSS Grid, React)" style="width: 100%; padding: 10px; margin: 15px 0; background-color: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: var(--light); border-radius: 5px;">
                <div id="cheatsheet-result" style="display: none;">
                    <div class="cheatsheet-section">
                        <h4 class="cheatsheet-title">Basic Syntax</h4>
                        <div class="cheatsheet-item">Item 1</div>
                        <div class="cheatsheet-item">Item 2</div>
                        <div class="cheatsheet-item">Item 3</div>
                    </div>
                    <div class="cheatsheet-section">
                        <h4 class="cheatsheet-title">Common Patterns</h4>
                        <div class="cheatsheet-item">Pattern 1</div>
                        <div class="cheatsheet-item">Pattern 2</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary-btn close-modal">Cancel</button>
                <button class="modal-btn primary-btn" id="generate-cheatsheet-btn">Generate Cheat Sheet</button>
            </div>
        </div>
    </div>
    
    <!-- Flashcard Modal -->
    <div class="modal" id="flashcard-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-layer-group"></i> Generate Flashcards</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Enter a topic and I'll create flashcards to help you study.</p>
                <input type="text" id="flashcard-topic" placeholder="Enter topic (e.g., Biology terms, French verbs)" style="width: 100%; padding: 10px; margin: 15px 0; background-color: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: var(--light); border-radius: 5px;">
                <div id="flashcard-result" style="display: none;">
                    <div class="flashcard-container" id="flashcard-container">
                        <!-- Flashcards will be generated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary-btn close-modal">Cancel</button>
                <button class="modal-btn primary-btn" id="generate-flashcards-btn">Generate Flashcards</button>
            </div>
        </div>
    </div>
    
    <!-- Mental Health Modal -->
    <div class="modal" id="mental-health-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-heart"></i> Mental Health Check</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Answer these questions to get a quick mental health assessment.</p>
                <div id="mh-questions">
                    <div class="mh-question">
                        <p>1. How often have you felt down, depressed, or hopeless in the past 2 weeks?</p>
                        <div class="mh-options">
                            <label class="mh-option"><input type="radio" name="q1" value="0"> Not at all</label>
                            <label class="mh-option"><input type="radio" name="q1" value="1"> Several days</label>
                            <label class="mh-option"><input type="radio" name="q1" value="2"> More than half the days</label>
                            <label class="mh-option"><input type="radio" name="q1" value="3"> Nearly every day</label>
                        </div>
                    </div>
                    <div class="mh-question">
                        <p>2. How often have you had little interest or pleasure in doing things?</p>
                        <div class="mh-options">
                            <label class="mh-option"><input type="radio" name="q2" value="0"> Not at all</label>
                            <label class="mh-option"><input type="radio" name="q2" value="1"> Several days</label>
                            <label class="mh-option"><input type="radio" name="q2" value="2"> More than half the days</label>
                            <label class="mh-option"><input type="radio" name="q2" value="3"> Nearly every day</label>
                        </div>
                    </div>
                    <div class="mh-question">
                        <p>3. How often have you felt nervous, anxious, or on edge?</p>
                        <div class="mh-options">
                            <label class="mh-option"><input type="radio" name="q3" value="0"> Not at all</label>
                            <label class="mh-option"><input type="radio" name="q3" value="1"> Several days</label>
                            <label class="mh-option"><input type="radio" name="q3" value="2"> More than half the days</label>
                            <label class="mh-option"><input type="radio" name="q3" value="3"> Nearly every day</label>
                        </div>
                    </div>
                </div>
                <div class="mh-result" id="mh-result">
                    <!-- Result will be shown here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn secondary-btn close-modal">Cancel</button>
                <button class="modal-btn primary-btn" id="assess-mh-btn">Get Assessment</button>
            </div>
        </div>
    </div>
    
    <script>
        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const fileInput = document.getElementById('file-input');
        const toneSlider = document.getElementById('tone-slider');
        const personaSelect = document.getElementById('persona-select');
        const contextBtn = document.getElementById('context-btn');
        const contextWindow = document.getElementById('context-window');
        const closeContext = document.getElementById('close-context');
        const contextList = document.getElementById('context-list');
        const timeline = document.getElementById('timeline');
        const themeBtns = document.querySelectorAll('.theme-btn');
        
        // Modal elements
        const modals = document.querySelectorAll('.modal');
        const closeModalBtns = document.querySelectorAll('.close-modal');
        const screenshotBtn = document.getElementById('screenshot-btn');
        const screenshotModal = document.getElementById('screenshot-modal');
        const screenshotUpload = document.getElementById('screenshot-upload');
        const previewImage = document.getElementById('preview-image');
        const generateCodeBtn = document.getElementById('generate-code-btn');
        const codeOutput = document.getElementById('code-output');
        
        const translateBtn = document.getElementById('translate-btn');
        const translateModal = document.getElementById('translation-modal');
        const translateTextBtn = document.getElementById('translate-text-btn');
        const sourceText = document.getElementById('source-text');
        const translatedText = document.getElementById('translated-text');
        
        const cheatsheetBtn = document.getElementById('cheatsheet-btn');
        const cheatsheetModal = document.getElementById('cheatsheet-modal');
        const cheatsheetTopic = document.getElementById('cheatsheet-topic');
        const generateCheatsheetBtn = document.getElementById('generate-cheatsheet-btn');
        const cheatsheetResult = document.getElementById('cheatsheet-result');
        
        const flashcardBtn = document.getElementById('flashcard-btn');
        const flashcardModal = document.getElementById('flashcard-modal');
        const flashcardTopic = document.getElementById('flashcard-topic');
        const generateFlashcardsBtn = document.getElementById('generate-flashcards-btn');
        const flashcardResult = document.getElementById('flashcard-result');
        const flashcardContainer = document.getElementById('flashcard-container');
        
        const mentalHealthBtn = document.getElementById('mental-health-btn');
        const mentalHealthModal = document.getElementById('mental-health-modal');
        const assessMhBtn = document.getElementById('assess-mh-btn');
        const mhResult = document.getElementById('mh-result');
        
        // Chat history
        let chatHistory = [
            {
                sender: 'bot',
                content: 'Hello! I\'m InfinityBot, your ultimate AI assistant with infinite memory and advanced capabilities. How can I help you today?',
                timestamp: new Date(),
                emotion: 'neutral',
                persona: 'default'
            }
        ];
        
        // Themes
        const themes = [
            {
                primary: '#6e48aa',
                secondary: '#9d50bb',
                dark: '#1a1a2e',
                light: '#f1f1f1'
            },
            {
                primary: '#1a1a2e',
                secondary: '#16213e',
                dark: '#0d0d1a',
                light: '#e6e6e6'
            },
            {
                primary: '#1e3c72',
                secondary: '#2a5298',
                dark: '#0f1b36',
                light: '#e6ecff'
            },
            {
                primary: '#614385',
                secondary: '#516395',
                dark: '#302244',
                light: '#f1e6ff'
            },
            {
                primary: '#0f2027',
                secondary: '#203a43',
                dark: '#09161a',
                light: '#e6f7ff'
            },
            {
                primary: '#ff416c',
                secondary: '#ff4b2b',
                dark: '#1a0a0e',
                light: '#ffe6eb'
            }
        ];
        
        // Initialize
        function init() {
            updateTimeline();
            
            // Event listeners
            sendBtn.addEventListener('click', sendMessage);
            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            fileInput.addEventListener('change', handleFileUpload);
            contextBtn.addEventListener('click', showContextWindow);
            closeContext.addEventListener('click', hideContextWindow);
            
            // Theme switcher
            themeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const themeIndex = parseInt(btn.getAttribute('data-theme')) - 1;
                    applyTheme(themeIndex);
                });
            });
            
            // Modal functionality
            screenshotBtn.addEventListener('click', () => screenshotModal.style.display = 'flex');
            translateBtn.addEventListener('click', () => translateModal.style.display = 'flex');
            cheatsheetBtn.addEventListener('click', () => cheatsheetModal.style.display = 'flex');
            flashcardBtn.addEventListener('click', () => flashcardModal.style.display = 'flex');
            mentalHealthBtn.addEventListener('click', () => mentalHealthModal.style.display = 'flex');
            
            closeModalBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    modals.forEach(modal => modal.style.display = 'none');
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
            
            // Screenshot to code functionality
            screenshotUpload.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        previewImage.src = event.target.result;
                        document.getElementById('screenshot-preview').style.display = 'block';
                        document.getElementById('generated-code').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            generateCodeBtn.addEventListener('click', () => {
                // Simulate code generation
                const htmlCode = `<!DOCTYPE html>
<html>
<head>
    <title>Generated UI</title>
    <style>
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        /* More styles based on the uploaded image */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">My App</div>
            <nav>
                <a href="#">Home</a>
                <a href="#">Features</a>
                <a href="#">Contact</a>
            </nav>
        </header>
        <main class="main-content">
            <!-- Content would be generated based on the image -->
        </main>
    </div>
</body>
</html>`;
                
                codeOutput.textContent = htmlCode;
                document.getElementById('generated-code').style.display = 'block';
            });
            
            // Translation functionality
            translateTextBtn.addEventListener('click', () => {
                const text = sourceText.value;
                if (text.trim() === '') return;
                
                // Simulate translation
                const languages = {
                    en: "English",
                    es: "Spanish",
                    fr: "French",
                    de: "German",
                    zh: "Chinese",
                    ja: "Japanese",
                    ru: "Russian",
                    ar: "Arabic"
                };
                
                const sourceLang = document.getElementById('source-language').value;
                const targetLang = document.getElementById('target-language').value;
                
                let translation;
                if (text.toLowerCase().includes('hello')) {
                    translation = {
                        en: "Hello",
                        es: "Hola",
                        fr: "Bonjour",
                        de: "Hallo",
                        zh: "你好",
                        ja: "こんにちは",
                        ru: "Привет",
                        ar: "مرحبا"
                    }[targetLang];
                } else if (text.toLowerCase().includes('thank')) {
                    translation = {
                        en: "Thank you",
                        es: "Gracias",
                        fr: "Merci",
                        de: "Danke",
                        zh: "谢谢",
                        ja: "ありがとう",
                        ru: "Спасибо",
                        ar: "شكرا"
                    }[targetLang];
                } else {
                    translation = `[Translated to ${languages[targetLang] || targetLang}]: ${text}`;
                }
                
                translatedText.value = translation;
            });
            
            // Cheatsheet functionality
            generateCheatsheetBtn.addEventListener('click', () => {
                const topic = cheatsheetTopic.value.trim();
                if (topic === '') return;
                
                // Simulate cheatsheet generation
                const sections = {
                    "Python": [
                        {
                            title: "Basic Syntax",
                            items: [
                                "Variables: x = 10",
                                "Lists: my_list = [1, 2, 3]",
                                "Dictionaries: my_dict = {'key': 'value'}",
                                "Loops: for item in collection:",
                                "Functions: def my_func(param):"
                            ]
                        },
                        {
                            title: "Common Patterns",
                            items: [
                                "List comprehension: [x*2 for x in range(10)]",
                                "Dictionary comprehension: {k: v*2 for k, v in my_dict.items()}",
                                "Lambda functions: lambda x: x*2",
                                "Context managers: with open('file.txt') as f:"
                            ]
                        }
                    ],
                    "CSS Grid": [
                        {
                            title: "Container Properties",
                            items: [
                                "display: grid",
                                "grid-template-columns: 1fr 1fr 1fr",
                                "grid-template-rows: 100px auto",
                                "gap: 10px"
                            ]
                        },
                        {
                            title: "Item Properties",
                            items: [
                                "grid-column: 1 / 3",
                                "grid-row: 1",
                                "grid-area: header",
                                "justify-self: center"
                            ]
                        }
                    ],
                    "React": [
                        {
                            title: "Components",
                            items: [
                                "Functional: const MyComp = () => { return <div>Hello</div>; }",
                                "Class: class MyComp extends React.Component { render() { return <div>Hello</div>; } }",
                                "Props: <MyComp prop1=\"value\" />",
                                "State: const [state, setState] = useState(initialValue)"
                            ]
                        },
                        {
                            title: "Hooks",
                            items: [
                                "useState: Manage component state",
                                "useEffect: Side effects",
                                "useContext: Access context",
                                "useReducer: Complex state logic"
                            ]
                        }
                    ]
                };
                
                let selectedSections = sections["Python"]; // Default
                
                for (const key in sections) {
                    if (topic.toLowerCase().includes(key.toLowerCase())) {
                        selectedSections = sections[key];
                        break;
                    }
                }
                
                cheatsheetResult.innerHTML = '';
                selectedSections.forEach(section => {
                    const sectionDiv = document.createElement('div');
                    sectionDiv.className = 'cheatsheet-section';
                    
                    const title = document.createElement('h4');
                    title.className = 'cheatsheet-title';
                    title.textContent = section.title;
                    
                    sectionDiv.appendChild(title);
                    
                    section.items.forEach(item => {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'cheatsheet-item';
                        itemDiv.textContent = item;
                        sectionDiv.appendChild(itemDiv);
                    });
                    
                    cheatsheetResult.appendChild(sectionDiv);
                });
                
                cheatsheetResult.style.display = 'block';
            });
            
            // Flashcards functionality
            generateFlashcardsBtn.addEventListener('click', () => {
                const topic = flashcardTopic.value.trim();
                if (topic === '') return;
                
                // Simulate flashcard generation
                const flashcards = {
                    "Biology": [
                        { question: "What is the powerhouse of the cell?", answer: "Mitochondria" },
                        { question: "What is the process by which plants make food?", answer: "Photosynthesis" },
                        { question: "What are the four nucleotide bases in DNA?", answer: "Adenine, Thymine, Cytosine, Guanine" }
                    ],
                    "French": [
                        { question: "How do you say 'Hello' in French?", answer: "Bonjour" },
                        { question: "How do you say 'Thank you' in French?", answer: "Merci" },
                        { question: "How do you say 'Goodbye' in French?", answer: "Au revoir" }
                    ],
                    "History": [
                        { question: "In what year did World War II end?", answer: "1945" },
                        { question: "Who was the first president of the United States?", answer: "George Washington" },
                        { question: "What ancient civilization built the pyramids?", answer: "Ancient Egyptians" }
                    ]
                };
                
                let selectedFlashcards = flashcards["Biology"]; // Default
                
                for (const key in flashcards) {
                    if (topic.toLowerCase().includes(key.toLowerCase())) {
                        selectedFlashcards = flashcards[key];
                        break;
                    }
                }
                
                flashcardContainer.innerHTML = '';
                selectedFlashcards.forEach((card, index) => {
                    const flashcard = document.createElement('div');
                    flashcard.className = 'flashcard';
                    flashcard.innerHTML = `
                        <div class="flashcard-question">${index + 1}. ${card.question}</div>
                        <div class="flashcard-answer">${card.answer}</div>
                    `;
                    
                    flashcard.addEventListener('click', () => {
                        flashcard.classList.toggle('show-answer');
                    });
                    
                    flashcardContainer.appendChild(flashcard);
                });
                
                flashcardResult.style.display = 'block';
            });
            
            // Mental health assessment
            assessMhBtn.addEventListener('click', () => {
                const answers = [
                    parseInt(document.querySelector('input[name="q1"]:checked')?.value || 0),
                    parseInt(document.querySelector('input[name="q2"]:checked')?.value || 0),
                    parseInt(document.querySelector('input[name="q3"]:checked')?.value || 0)
                ];
                
                const totalScore = answers.reduce((sum, score) => sum + score, 0);
                
                let assessment;
                if (totalScore === 0) {
                    assessment = "Your responses suggest you're doing well mentally. Keep up the good self-care!";
                } else if (totalScore <= 3) {
                    assessment = "You're experiencing some mild symptoms. Consider practicing self-care and monitoring your mood.";
                } else if (totalScore <= 6) {
                    assessment = "You're experiencing moderate symptoms. You might benefit from talking to a professional.";
                } else {
                    assessment = "Your responses suggest significant symptoms. Please consider reaching out to a mental health professional for support.";
                }
                
                mhResult.innerHTML = `
                    <h4>Your Assessment</h4>
                    <p>Score: ${totalScore}/9</p>
                    <p>${assessment}</p>
                    <p style="margin-top: 10px; font-size: 14px;">
                        <strong>Resources:</strong> 
                        <a href="https://www.mentalhealth.gov/" target="_blank" style="color: var(--secondary);">MentalHealth.gov</a> | 
                        <a href="https://www.nami.org/" target="_blank" style="color: var(--secondary);">NAMI</a> | 
                        <a href="https://suicidepreventionlifeline.org/" target="_blank" style="color: var(--secondary);">Suicide Prevention Lifeline</a>
                    </p>
                `;
                mhResult.style.display = 'block';
            });
        }
        
        // Send message
        function sendMessage() {
            const message = userInput.value.trim();
            if (message === '') return;
            
            // Add user message to chat
            addMessage('user', message);
            userInput.value = '';
            
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'typing-indicator';
            typingIndicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <span>InfinityBot is typing...</span>
            `;
            chatMessages.appendChild(typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate bot response after a delay
            setTimeout(() => {
                // Remove typing indicator
                chatMessages.removeChild(typingIndicator);
                
                // Generate bot response
                const tone = toneSlider.value;
                const persona = personaSelect.value;
                const response = generateBotResponse(message, tone, persona);
                
                // Add bot message to chat
                addMessage('bot', response);
                
                // Update timeline
                updateTimeline();
            }, 1000 + Math.random() * 1000); // Random delay between 1-2 seconds
        }
        
        // Add message to chat
        function addMessage(sender, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const now = new Date();
            const timestamp = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <span>${sender === 'user' ? 'You' : 'InfinityBot'}</span>
                    <span>${timestamp}</span>
                </div>
                <div class="message-content">${formatContent(content)}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to chat history
            chatHistory.push({
                sender,
                content,
                timestamp: now,
                emotion: detectEmotion(content),
                persona: sender === 'bot' ? personaSelect.value : null
            });
        }
        
        // Format message content
        function formatContent(content) {
            // Simple formatting for demonstration
            // In a real app, you'd have more sophisticated formatting
            if (content.includes('```')) {
                return content.replace(/```([\s\S]*?)```/g, '<div class="code-block">$1</div>');
            }
            return content.replace(/\n/g, '<br>');
        }
        
        // Generate bot response
        function generateBotResponse(message, tone, persona) {
            // This is a simplified version
            // In a real app, you'd call an API or use more sophisticated logic
            
            const responses = {
                default: [
                    "I've analyzed your request and here's what I found...",
                    "Based on my infinite knowledge base, I can tell you that...",
                    "Interesting question! Let me break this down for you..."
                ],
                sun_tzu: [
                    "In the art of conversation, as in war, the direct approach may not always be best. Consider instead...",
                    "Know thy question as you know yourself, and you need not fear the answer. Thus I say to you...",
                    "The supreme art of discourse is to subdue the inquirer without confusion. Therefore..."
                ],
                mr_robot: [
                    "Look, I get what you're asking, but the truth is more complicated. The system wants you to think...",
                    "*sigh* Okay, let me hack through the BS and give it to you straight...",
                    "You're asking the right questions, but you're not seeing the whole picture. The reality is..."
                ],
                defcon: [
                    "Alright, let's talk security here. What you're dealing with is a classic case of...",
                    "In my 20 years of infosec, I've seen this pattern before. Here's how we handle it...",
                    "Red team, blue team - doesn't matter. The vulnerability here is clearly..."
                ],
                sherlock: [
                    "Elementary, my dear user. The solution becomes apparent when we observe that...",
                    "The game is afoot! By examining the evidence, we can deduce that...",
                    "You see, but you do not observe. The crucial detail here is..."
                ],
                einstein: [
                    "E=mc² may not directly apply here, but the principle is similar. Consider that...",
                    "Imagination is more important than knowledge in this case. Let me explain...",
                    "The important thing is not to stop questioning. In this situation..."
                ]
            };
            
            const personaResponses = responses[persona] || responses.default;
            const randomResponse = personaResponses[Math.floor(Math.random() * personaResponses.length)];
            
            // Adjust tone
            let response = randomResponse;
            if (tone < 30) {
                // Very casual
                response = response.replace(/I've/g, "I've").replace(/here's/g, "here's");
                response = "Hey! " + response.toLowerCase();
            } else if (tone > 70) {
                // Very professional
                response = response.replace(/I've/g, "I have").replace(/here's/g, "here is");
                response = "After careful consideration, " + response;
            }
            
            // Add some code blocks if the message seems technical
            if (message.toLowerCase().includes('code') || message.toLowerCase().includes('program')) {
                return `${response}\n\nHere's an example:\n\`\`\`javascript\nfunction example() {\n  // This is a sample code block\n  return "Hello, world!";\n}\n\`\`\``;
            }
            
            // Add some special responses for certain keywords
            if (message.toLowerCase().includes('hello') || message.toLowerCase().includes('hi')) {
                return `${response}\n\nBy the way, I can speak multiple languages! Try the translation feature if you'd like me to translate something.`;
            }
            
            if (message.toLowerCase().includes('help')) {
                return `${response}\n\nRemember, I have many features like cheat sheet generation, flashcards, and mental health check. Feel free to explore them!`;
            }
            
            return response;
        }
        
        // Detect emotion from text (simplified)
        function detectEmotion(text) {
            const lowerText = text.toLowerCase();
            if (lowerText.includes('!') || lowerText.includes('great') || lowerText.includes('awesome')) return 'joy';
            if (lowerText.includes('?') || lowerText.includes('why') || lowerText.includes('how')) return 'surprise';
            if (lowerText.includes('sad') || lowerText.includes('bad') || lowerText.includes('worried')) return 'sadness';
            if (lowerText.includes('angry') || lowerText.includes('mad') || lowerText.includes('hate')) return 'anger';
            return 'neutral';
        }
        
        // Handle file upload
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Simulate processing
            addMessage('user', `[Uploaded file: ${file.name}]`);
            
            setTimeout(() => {
                // Simulate analysis
                let response;
                if (file.type.startsWith('image/')) {
                    response = "I've analyzed the screenshot and detected the following elements...\n\n";
                    response += "1. UI components resembling a web application\n";
                    response += "2. Form fields and buttons\n";
                    response += "3. Color scheme and layout patterns\n\n";
                    response += "Would you like me to generate code for this interface?";
                } else {
                    response = "I've processed your document and extracted the key information:\n\n";
                    response += "- Main topics: AI, Machine Learning, Neural Networks\n";
                    response += "- Key points: 5 important concepts identified\n";
                    response += "- Sentiment: Generally positive with some critical observations\n\n";
                    response += "How would you like to proceed with this content?";
                }
                
                addMessage('bot', response);
                updateTimeline();
            }, 1500);
        }
        
        // Show context window
        function showContextWindow() {
            contextList.innerHTML = '';
            
            // Add context items
            chatHistory.forEach((item, index) => {
                const contextItem = document.createElement('div');
                contextItem.className = 'context-item';
                
                const date = item.timestamp.toLocaleDateString();
                const time = item.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const truncatedContent = item.content.length > 100 
                    ? item.content.substring(0, 100) + '...' 
                    : item.content;
                
                contextItem.innerHTML = `
                    <div><strong>${item.sender === 'user' ? 'You' : 'InfinityBot'}</strong> • ${date} ${time}</div>
                    <div>${truncatedContent}</div>
                `;
                
                contextItem.addEventListener('click', () => {
                    // Scroll to the message in chat
                    const messages = document.querySelectorAll('.message');
                    if (index < messages.length) {
                        messages[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
                        messages[index].style.animation = 'fadeIn 0.5s';
                        setTimeout(() => {
                            messages[index].style.animation = '';
                        }, 500);
                    }
                    hideContextWindow();
                });
                
                contextList.appendChild(contextItem);
            });
            
            contextWindow.classList.add('active');
        }
        
        // Hide context window
        function hideContextWindow() {
            contextWindow.classList.remove('active');
        }
        
        // Update timeline
        function updateTimeline() {
            timeline.innerHTML = '';
            
            // Group by date
            const grouped = {};
            chatHistory.forEach(item => {
                const date = item.timestamp.toLocaleDateString();
                if (!grouped[date]) grouped[date] = [];
                grouped[date].push(item);
            });
            
            // Add to timeline
            Object.keys(grouped).forEach(date => {
                const dateHeader = document.createElement('div');
                dateHeader.className = 'timeline-date';
                dateHeader.textContent = date;
                timeline.appendChild(dateHeader);
                
                grouped[date].forEach(item => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    
                    const time = item.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    const truncatedContent = item.content.length > 50 
                        ? item.content.substring(0, 50) + '...' 
                        : item.content;
                    
                    timelineItem.innerHTML = `
                        <div class="timeline-content">${truncatedContent}</div>
                    `;
                    
                    timelineItem.addEventListener('click', () => {
                        // Scroll to the message in chat
                        const index = chatHistory.indexOf(item);
                        const messages = document.querySelectorAll('.message');
                        if (index < messages.length) {
                            messages[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
                            messages[index].style.animation = 'fadeIn 0.5s';
                            setTimeout(() => {
                                messages[index].style.animation = '';
                            }, 500);
                        }
                    });
                    
                    timeline.appendChild(timelineItem);
                });
            });
        }
        
        // Apply theme
        function applyTheme(index) {
            const theme = themes[index];
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            document.documentElement.style.setProperty('--dark', theme.dark);
            document.documentElement.style.setProperty('--light', theme.light);
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>
