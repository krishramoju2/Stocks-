
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfinityBot - Ultimate AI Assistant</title>
    <style>
        :root {
            --primary: #6e48aa;
            --secondary: #9d50bb;
            --dark: #1a1a2e;
            --light: #f1f1f1;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --info: #2196F3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            min-height: 100vh;
            background-image: radial-gradient(circle at 10% 20%, rgba(110, 72, 170, 0.2) 0%, rgba(157, 80, 187, 0.2) 90%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .theme-selector {
            display: flex;
            gap: 10px;
        }
        
        .theme-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid var(--light);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .theme-btn:hover {
            transform: scale(1.1);
        }
        
        .theme-1 { background: linear-gradient(135deg, #6e48aa, #9d50bb); }
        .theme-2 { background: linear-gradient(135deg, #1a1a2e, #16213e); }
        .theme-3 { background: linear-gradient(135deg, #1e3c72, #2a5298); }
        .theme-4 { background: linear-gradient(135deg, #614385, #516395); }
        .theme-5 { background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); }
        .theme-6 { background: linear-gradient(135deg, #ff416c, #ff4b2b); }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }
        
        .sidebar {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-title i {
            font-size: 20px;
        }
        
        .tone-control {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .tone-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .persona-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            margin-bottom: 15px;
        }
        
        .feature-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }
        
        .feature-btn:hover {
            background-color: rgba(110, 72, 170, 0.3);
            border-color: var(--primary);
        }
        
        .feature-btn i {
            margin-right: 10px;
        }
        
        .chat-container {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 80vh;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 20px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 10px;
            line-height: 1.6;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background-color: rgba(110, 72, 170, 0.3);
            border-left: 4px solid var(--primary);
            margin-left: 40px;
        }
        
        .bot-message {
            background-color: rgba(26, 26, 46, 0.6);
            border-left: 4px solid var(--secondary);
            margin-right: 40px;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .message-content {
            white-space: pre-wrap;
        }
        
        .code-block {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }
        
        .text-input {
            flex: 1;
            padding: 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            resize: none;
            min-height: 60px;
            max-height: 150px;
        }
        
        .text-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .send-btn {
            padding: 0 20px;
            border-radius: 5px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .send-btn:hover {
            transform: scale(1.05);
        }
        
        .file-upload {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 15px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            background-color: rgba(110, 72, 170, 0.3);
            border-color: var(--primary);
        }
        
        .file-upload input {
            display: none;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .stat-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .emotion-indicator {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .emotion-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .anger { background-color: var(--danger); }
        .joy { background-color: var(--success); }
        .sadness { background-color: var(--info); }
        .surprise { background-color: var(--warning); }
        .neutral { background-color: rgba(255, 255, 255, 0.5); }
        
        .timeline-container {
            margin-top: 30px;
        }
        
        .timeline-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .timeline {
            position: relative;
            max-height: 200px;
            overflow-y: auto;
            padding-left: 20px;
            border-left: 2px solid var(--primary);
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 20px;
            cursor: pointer;
        }
        
        .timeline-item:last-child {
            padding-bottom: 0;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--secondary);
        }
        
        .timeline-date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .timeline-content {
            font-size: 14px;
            margin-top: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 15px;
            background-color: rgba(26, 26, 46, 0.6);
            border-radius: 10px;
            margin-bottom: 15px;
            width: fit-content;
            align-items: center;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--secondary);
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        .context-window {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .context-window.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .context-content {
            background-color: var(--dark);
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--primary);
            position: relative;
        }
        
        .close-context {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
        }
        
        .context-title {
            margin-bottom: 20px;
            color: var(--secondary);
        }
        
        .context-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .context-item:hover {
            background-color: rgba(110, 72, 170, 0.1);
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .sidebar {
                margin-bottom: 20px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">InfinityBot</div>
            <div class="theme-selector">
                <div class="theme-btn theme-1" data-theme="1"></div>
                <div class="theme-btn theme-2" data-theme="2"></div>
                <div class="theme-btn theme-3" data-theme="3"></div>
                <div class="theme-btn theme-4" data-theme="4"></div>
                <div class="theme-btn theme-5" data-theme="5"></div>
                <div class="theme-btn theme-6" data-theme="6"></div>
            </div>
        </header>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-title">Response Time</div>
                <div class="stat-value">0.24s</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Context Length</div>
                <div class="stat-value">∞</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Languages</div>
                <div class="stat-value">127</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Emotions Detected</div>
                <div class="stat-value">27</div>
                <div class="emotion-indicator">
                    <div class="emotion-dot anger" title="Anger"></div>
                    <div class="emotion-dot joy" title="Joy"></div>
                    <div class="emotion-dot sadness" title="Sadness"></div>
                    <div class="emotion-dot surprise" title="Surprise"></div>
                    <div class="emotion-dot neutral" title="Neutral"></div>
                    <div class="emotion-dot" style="color: rgba(255,255,255,0.7); font-size: 10px;">+22</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-sliders-h"></i> Tone Control</div>
                    <input type="range" min="0" max="100" value="50" class="tone-control" id="tone-slider">
                    <div class="tone-labels">
                        <span>Casual</span>
                        <span>Professional</span>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-user-alt"></i> Persona Mode</div>
                    <select class="persona-select" id="persona-select">
                        <option value="default">Default</option>
                        <option value="sun_tzu">Sun Tzu</option>
                        <option value="mr_robot">Mr. Robot</option>
                        <option value="defcon">DEFCON Speaker</option>
                        <option value="sherlock">Sherlock Holmes</option>
                        <option value="einstein">Albert Einstein</option>
                        <option value="custom">Custom...</option>
                    </select>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-magic"></i> Features</div>
                    <button class="feature-btn" id="screenshot-btn"><i class="fas fa-camera"></i> Screenshot to Code</button>
                    <button class="feature-btn" id="translate-btn"><i class="fas fa-language"></i> Multilingual Translation</button>
                    <button class="feature-btn" id="cheatsheet-btn"><i class="fas fa-file-alt"></i> Create Cheat Sheet</button>
                    <button class="feature-btn" id="flashcard-btn"><i class="fas fa-layer-group"></i> Generate Flashcards</button>
                    <button class="feature-btn" id="mental-health-btn"><i class="fas fa-heart"></i> Mental Health Check</button>
                    <button class="feature-btn" id="context-btn"><i class="fas fa-infinity"></i> Infinite Context</button>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title"><i class="fas fa-history"></i> Timeline</div>
                    <div class="timeline-container">
                        <div class="timeline" id="timeline">
                            <!-- Timeline items will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <div class="message bot-message">
                        <div class="message-header">
                            <span>InfinityBot</span>
                            <span>Just now</span>
                        </div>
                        <div class="message-content">
                            Hello! I'm InfinityBot, your ultimate AI assistant with infinite memory and advanced capabilities. How can I help you today?
                        </div>
                    </div>
                </div>
                
                <div class="input-area">
                    <label class="file-upload" title="Upload screenshot or file">
                        <input type="file" id="file-input" accept="image/*,.pdf,.doc,.docx,.txt">
                        <i class="fas fa-paperclip"></i>
                    </label>
                    <textarea class="text-input" id="user-input" placeholder="Type your message here..."></textarea>
                    <button class="send-btn" id="send-btn"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="context-window" id="context-window">
        <div class="context-content">
            <button class="close-context" id="close-context">&times;</button>
            <h3 class="context-title">Infinite Context Memory</h3>
            <div id="context-list">
                <!-- Context items will be added here dynamically -->
            </div>
        </div>
    </div>
    
    <script>
        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const fileInput = document.getElementById('file-input');
        const toneSlider = document.getElementById('tone-slider');
        const personaSelect = document.getElementById('persona-select');
        const contextBtn = document.getElementById('context-btn');
        const contextWindow = document.getElementById('context-window');
        const closeContext = document.getElementById('close-context');
        const contextList = document.getElementById('context-list');
        const timeline = document.getElementById('timeline');
        const themeBtns = document.querySelectorAll('.theme-btn');
        
        // Chat history
        let chatHistory = [
            {
                sender: 'bot',
                content: 'Hello! I\'m InfinityBot, your ultimate AI assistant with infinite memory and advanced capabilities. How can I help you today?',
                timestamp: new Date(),
                emotion: 'neutral',
                persona: 'default'
            }
        ];
        
        // Themes
        const themes = [
            {
                primary: '#6e48aa',
                secondary: '#9d50bb',
                dark: '#1a1a2e',
                light: '#f1f1f1'
            },
            {
                primary: '#1a1a2e',
                secondary: '#16213e',
                dark: '#0d0d1a',
                light: '#e6e6e6'
            },
            {
                primary: '#1e3c72',
                secondary: '#2a5298',
                dark: '#0f1b36',
                light: '#e6ecff'
            },
            {
                primary: '#614385',
                secondary: '#516395',
                dark: '#302244',
                light: '#f1e6ff'
            },
            {
                primary: '#0f2027',
                secondary: '#203a43',
                dark: '#09161a',
                light: '#e6f7ff'
            },
            {
                primary: '#ff416c',
                secondary: '#ff4b2b',
                dark: '#1a0a0e',
                light: '#ffe6eb'
            }
        ];
        
        // Initialize
        function init() {
            updateTimeline();
            
            // Event listeners
            sendBtn.addEventListener('click', sendMessage);
            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            fileInput.addEventListener('change', handleFileUpload);
            contextBtn.addEventListener('click', showContextWindow);
            closeContext.addEventListener('click', hideContextWindow);
            
            // Theme switcher
            themeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const themeIndex = parseInt(btn.getAttribute('data-theme')) - 1;
                    applyTheme(themeIndex);
                });
            });
        }
        
        // Send message
        function sendMessage() {
            const message = userInput.value.trim();
            if (message === '') return;
            
            // Add user message to chat
            addMessage('user', message);
            userInput.value = '';
            
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'typing-indicator';
            typingIndicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <span>InfinityBot is typing...</span>
            `;
            chatMessages.appendChild(typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate bot response after a delay
            setTimeout(() => {
                // Remove typing indicator
                chatMessages.removeChild(typingIndicator);
                
                // Generate bot response
                const tone = toneSlider.value;
                const persona = personaSelect.value;
                const response = generateBotResponse(message, tone, persona);
                
                // Add bot message to chat
                addMessage('bot', response);
                
                // Update timeline
                updateTimeline();
            }, 1000 + Math.random() * 1000); // Random delay between 1-2 seconds
        }
        
        // Add message to chat
        function addMessage(sender, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const now = new Date();
            const timestamp = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <span>${sender === 'user' ? 'You' : 'InfinityBot'}</span>
                    <span>${timestamp}</span>
                </div>
                <div class="message-content">${formatContent(content)}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to chat history
            chatHistory.push({
                sender,
                content,
                timestamp: now,
                emotion: detectEmotion(content),
                persona: sender === 'bot' ? personaSelect.value : null
            });
        }
        
        // Format message content
        function formatContent(content) {
            // Simple formatting for demonstration
            // In a real app, you'd have more sophisticated formatting
            if (content.includes('```')) {
                return content.replace(/```([\s\S]*?)```/g, '<div class="code-block">$1</div>');
            }
            return content.replace(/\n/g, '<br>');
        }
        
        // Generate bot response
        function generateBotResponse(message, tone, persona) {
            // This is a simplified version
            // In a real app, you'd call an API or use more sophisticated logic
            
            const responses = {
                default: [
                    "I've analyzed your request and here's what I found...",
                    "Based on my infinite knowledge base, I can tell you that...",
                    "Interesting question! Let me break this down for you..."
                ],
                sun_tzu: [
                    "In the art of conversation, as in war, the direct approach may not always be best. Consider instead...",
                    "Know thy question as you know yourself, and you need not fear the answer. Thus I say to you...",
                    "The supreme art of discourse is to subdue the inquirer without confusion. Therefore..."
                ],
                mr_robot: [
                    "Look, I get what you're asking, but the truth is more complicated. The system wants you to think...",
                    "*sigh* Okay, let me hack through the BS and give it to you straight...",
                    "You're asking the right questions, but you're not seeing the whole picture. The reality is..."
                ],
                defcon: [
                    "Alright, let's talk security here. What you're dealing with is a classic case of...",
                    "In my 20 years of infosec, I've seen this pattern before. Here's how we handle it...",
                    "Red team, blue team - doesn't matter. The vulnerability here is clearly..."
                ]
            };
            
            const personaResponses = responses[persona] || responses.default;
            const randomResponse = personaResponses[Math.floor(Math.random() * personaResponses.length)];
            
            // Add some code blocks if the message seems technical
            if (message.toLowerCase().includes('code') || message.toLowerCase().includes('program')) {
                return `${randomResponse}\n\nHere's an example:\n\`\`\`javascript\nfunction example() {\n  // This is a sample code block\n  return "Hello, world!";\n}\n\`\`\``;
            }
            
            return randomResponse;
        }
        
        // Detect emotion from text (simplified)
        function detectEmotion(text) {
            const lowerText = text.toLowerCase();
            if (lowerText.includes('!') || lowerText.includes('great') || lowerText.includes('awesome')) return 'joy';
            if (lowerText.includes('?') || lowerText.includes('why') || lowerText.includes('how')) return 'surprise';
            if (lowerText.includes('sad') || lowerText.includes('bad') || lowerText.includes('worried')) return 'sadness';
            if (lowerText.includes('angry') || lowerText.includes('mad') || lowerText.includes('hate')) return 'anger';
            return 'neutral';
        }
        
        // Handle file upload
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Simulate processing
            addMessage('user', `[Uploaded file: ${file.name}]`);
            
            setTimeout(() => {
                // Simulate analysis
                let response;
                if (file.type.startsWith('image/')) {
                    response = "I've analyzed the screenshot and detected the following elements...\n\n";
                    response += "1. UI components resembling a web application\n";
                    response += "2. Form fields and buttons\n";
                    response += "3. Color scheme and layout patterns\n\n";
                    response += "Would you like me to generate code for this interface?";
                } else {
                    response = "I've processed your document and extracted the key information:\n\n";
                    response += "- Main topics: AI, Machine Learning, Neural Networks\n";
                    response += "- Key points: 5 important concepts identified\n";
                    response += "- Sentiment: Generally positive with some critical observations\n\n";
                    response += "How would you like to proceed with this content?";
                }
                
                addMessage('bot', response);
                updateTimeline();
            }, 1500);
        }
        
        // Show context window
        function showContextWindow() {
            contextList.innerHTML = '';
            
            // Add context items
            chatHistory.forEach((item, index) => {
                const contextItem = document.createElement('div');
                contextItem.className = 'context-item';
                
                const date = item.timestamp.toLocaleDateString();
                const time = item.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const truncatedContent = item.content.length > 100 
                    ? item.content.substring(0, 100) + '...' 
                    : item.content;
                
                contextItem.innerHTML = `
                    <div><strong>${item.sender === 'user' ? 'You' : 'InfinityBot'}</strong> • ${date} ${time}</div>
                    <div>${truncatedContent}</div>
                `;
                
                contextItem.addEventListener('click', () => {
                    // Scroll to the message in chat
                    const messages = document.querySelectorAll('.message');
                    if (index < messages.length) {
                        messages[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
                        messages[index].style.animation = 'fadeIn 0.5s';
                        setTimeout(() => {
                            messages[index].style.animation = '';
                        }, 500);
                    }
                    hideContextWindow();
                });
                
                contextList.appendChild(contextItem);
            });
            
            contextWindow.classList.add('active');
        }
        
        // Hide context window
        function hideContextWindow() {
            contextWindow.classList.remove('active');
        }
        
        // Update timeline
        function updateTimeline() {
            timeline.innerHTML = '';
            
            // Group by date
            const grouped = {};
            chatHistory.forEach(item => {
                const date = item.timestamp.toLocaleDateString();
                if (!grouped[date]) grouped[date] = [];
                grouped[date].push(item);
            });
            
            // Add to timeline
            Object.keys(grouped).forEach(date => {
                const dateHeader = document.createElement('div');
                dateHeader.className = 'timeline-date';
                dateHeader.textContent = date;
                timeline.appendChild(dateHeader);
                
                grouped[date].forEach(item => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = 'timeline-item';
                    
                    const time = item.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    const truncatedContent = item.content.length > 50 
                        ? item.content.substring(0, 50) + '...' 
                        : item.content;
                    
                    timelineItem.innerHTML = `
                        <div class="timeline-content">${truncatedContent}</div>
                    `;
                    
                    timelineItem.addEventListener('click', () => {
                        // Scroll to the message in chat
                        const index = chatHistory.indexOf(item);
                        const messages = document.querySelectorAll('.message');
                        if (index < messages.length) {
                            messages[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
                            messages[index].style.animation = 'fadeIn 0.5s';
                            setTimeout(() => {
                                messages[index].style.animation = '';
                            }, 500);
                        }
                    });
                    
                    timeline.appendChild(timelineItem);
                });
            });
        }
        
        // Apply theme
        function applyTheme(index) {
            const theme = themes[index];
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            document.documentElement.style.setProperty('--dark', theme.dark);
            document.documentElement.style.setProperty('--light', theme.light);
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>
